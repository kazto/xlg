# Excel Grep Tool 開発タスク

## Phase 1: 基盤準備
- [x] 1.1 プロジェクト構造の作成
  - [x] lib/ ディレクトリの作成
  - [x] bin/ ディレクトリの作成
  - [x] test/ ディレクトリの作成
- [x] 1.2 依存関係の確認
  - [x] rubyXL gem のインストール確認
  - [x] bundler の設定確認

## Phase 2: コアクラスの実装
- [x] 2.1 CellMatcher クラスの実装
  - [x] `match?` メソッドの実装
  - [x] `extract_match` メソッドの実装
  - [x] 大文字小文字の考慮
- [x] 2.2 OutputFormatter クラスの実装
  - [x] `format` メソッドの実装
  - [x] grep形式の出力フォーマット
- [x] 2.3 ExcelGrep クラスの実装
  - [x] `initialize` メソッドの実装
  - [x] `validate_file` メソッドの実装
  - [x] `search` メソッドの実装

## Phase 3: コマンドライン機能
- [x] 3.1 コマンドライン引数の解析
  - [x] ARGV の処理
  - [x] 引数の妥当性検証
  - [x] ヘルプメッセージの実装
- [x] 3.2 メインスクリプトの作成
  - [x] bin/xlg 実行ファイルの作成
  - [x] 実行権限の設定
  - [x] shebang の設定

## Phase 4: Excel ファイル処理
- [x] 4.1 Excel ファイルの読み込み
  - [x] rubyXL を使用したファイル読み込み
  - [x] シート一覧の取得
- [x] 4.2 セル内容の検索
  - [x] 全シートの走査
  - [x] 全セルの走査
  - [x] セル値の取得と文字列変換
- [x] 4.3 検索結果の出力
  - [x] マッチしたセルの位置特定
  - [x] 出力フォーマットの適用

## Phase 5: エラーハンドリング
- [x] 5.1 ファイル関連エラー
  - [x] ファイル存在チェック
  - [x] 読み込み権限チェック
  - [x] Excel ファイル形式チェック
- [x] 5.2 引数関連エラー
  - [x] 引数数のチェック
  - [x] キーワードの妥当性チェック
- [x] 5.3 例外処理
  - [x] rubyXL エラーのハンドリング
  - [x] 適切なエラーメッセージ

## Phase 6: テスト
- [x] 6.1 ユニットテストの作成
  - [x] CellMatcher のテスト
  - [x] OutputFormatter のテスト
  - [x] ExcelGrep のテスト
- [x] 6.2 統合テストの作成
  - [x] テスト用 Excel ファイルの準備
  - [x] コマンドライン実行テスト
- [x] 6.3 エッジケースのテスト
  - [x] 空のセル
  - [x] 数値セル
  - [x] 日付セル

## Phase 7: 最終調整
- [x] 7.1 パフォーマンス最適化
  - [x] 大きなファイルでの動作確認
  - [x] メモリ使用量の最適化
- [x] 7.2 ドキュメント整備
  - [x] README の作成
  - [x] 使用例の追加
- [x] 7.3 配布準備
  - [x] gem 化の検討
  - [x] インストール手順の整備

## Phase 8: 正規表現機能追加
- [x] 8.1 CellMatcher クラスの正規表現対応
  - [x] `is_regex?` メソッドの実装（パターンが正規表現かどうかを判定）
  - [x] `compile_pattern` メソッドの実装（パターンを正規表現オブジェクトに変換）
  - [x] `initialize` メソッドの更新（検索パターンを初期化）
  - [x] `match?` メソッドの更新（正規表現マッチングに対応）
  - [x] `extract_match` メソッドの更新（正規表現マッチ結果の抽出）
- [x] 8.2 ExcelGrep クラスの正規表現対応
  - [x] `initialize` メソッドの更新（patternパラメータに変更）
  - [x] CellMatcherとの連携更新
- [x] 8.3 MultiFileSearcher クラスの正規表現対応
  - [x] `initialize` メソッドの更新（patternパラメータに変更）
  - [x] ExcelGrepとの連携更新
- [x] 8.4 エラーハンドリングの追加
  - [x] 正規表現パターン構文エラーの検出
  - [x] 適切なエラーメッセージの実装
  - [x] 不正な正規表現に対する例外処理

## Phase 9: 正規表現機能のテスト
- [x] 9.1 CellMatcher 正規表現テストの追加
  - [x] 基本的な正規表現パターンのテスト
  - [x] 大文字小文字を区別しない検索のテスト
  - [x] 複雑なパターン（OR, 文字クラス等）のテスト
  - [x] 不正な正規表現パターンのエラーテスト
- [x] 9.2 統合テストの追加
  - [x] 正規表現を使った実際のExcelファイル検索テスト
  - [x] 日付パターン検索のテスト
  - [x] 数値パターン検索のテスト
  - [x] 複数ファイルでの正規表現検索テスト
- [x] 9.3 エッジケースのテスト
  - [x] 空文字列に対する正規表現マッチング
  - [x] 特殊文字を含むセルでの正規表現検索
  - [x] 非常に長い正規表現パターンのテスト

## Phase 10: ドキュメント更新と最終調整
- [ ] 10.1 ヘルプメッセージの更新
  - [ ] 正規表現機能の使用方法を追加
  - [ ] 正規表現の例を追加
- [ ] 10.2 README の更新
  - [ ] 正規表現機能の説明を追加
  - [ ] 使用例の追加
- [ ] 10.3 パフォーマンステスト
  - [ ] 正規表現検索のパフォーマンス確認
  - [ ] 大きなファイルでの正規表現検索テスト