# Excel Grep Tool 開発タスク

## Phase 1: 基盤準備
- [x] 1.1 プロジェクト構造の作成
  - [x] lib/ ディレクトリの作成
  - [x] bin/ ディレクトリの作成
  - [x] test/ ディレクトリの作成
- [x] 1.2 依存関係の確認
  - [x] rubyXL gem のインストール確認
  - [x] bundler の設定確認

## Phase 2: コアクラスの実装
- [x] 2.1 CellMatcher クラスの実装
  - [x] `match?` メソッドの実装
  - [x] `extract_match` メソッドの実装
  - [x] 大文字小文字の考慮
- [x] 2.2 OutputFormatter クラスの実装
  - [x] `format` メソッドの実装
  - [x] grep形式の出力フォーマット
- [x] 2.3 ExcelGrep クラスの実装
  - [x] `initialize` メソッドの実装
  - [x] `validate_file` メソッドの実装
  - [x] `search` メソッドの実装

## Phase 3: コマンドライン機能
- [x] 3.1 コマンドライン引数の解析
  - [x] ARGV の処理
  - [x] 引数の妥当性検証
  - [x] ヘルプメッセージの実装
- [x] 3.2 メインスクリプトの作成
  - [x] bin/xlg 実行ファイルの作成
  - [x] 実行権限の設定
  - [x] shebang の設定

## Phase 4: Excel ファイル処理
- [x] 4.1 Excel ファイルの読み込み
  - [x] rubyXL を使用したファイル読み込み
  - [x] シート一覧の取得
- [x] 4.2 セル内容の検索
  - [x] 全シートの走査
  - [x] 全セルの走査
  - [x] セル値の取得と文字列変換
- [x] 4.3 検索結果の出力
  - [x] マッチしたセルの位置特定
  - [x] 出力フォーマットの適用

## Phase 5: エラーハンドリング
- [x] 5.1 ファイル関連エラー
  - [x] ファイル存在チェック
  - [x] 読み込み権限チェック
  - [x] Excel ファイル形式チェック
- [x] 5.2 引数関連エラー
  - [x] 引数数のチェック
  - [x] キーワードの妥当性チェック
- [x] 5.3 例外処理
  - [x] rubyXL エラーのハンドリング
  - [x] 適切なエラーメッセージ

## Phase 6: テスト
- [x] 6.1 ユニットテストの作成
  - [x] CellMatcher のテスト
  - [x] OutputFormatter のテスト
  - [x] ExcelGrep のテスト
- [x] 6.2 統合テストの作成
  - [x] テスト用 Excel ファイルの準備
  - [x] コマンドライン実行テスト
- [x] 6.3 エッジケースのテスト
  - [x] 空のセル
  - [x] 数値セル
  - [x] 日付セル

## Phase 7: 最終調整
- [x] 7.1 パフォーマンス最適化
  - [x] 大きなファイルでの動作確認
  - [x] メモリ使用量の最適化
- [x] 7.2 ドキュメント整備
  - [x] README の作成
  - [x] 使用例の追加
- [x] 7.3 配布準備
  - [x] gem 化の検討
  - [x] インストール手順の整備